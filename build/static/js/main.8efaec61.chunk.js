(this["webpackJsonpfora-test"]=this["webpackJsonpfora-test"]||[]).push([[0],{10:function(e,t,n){e.exports={InviteForm:"InviteForm_InviteForm__1qRKh",none:"InviteForm_none__3oq5L",InviteForm__input:"InviteForm_InviteForm__input__ZrSMB",InviteForm__sendBtn:"InviteForm_InviteForm__sendBtn__27L2D",InviteForm__closeBtn:"InviteForm_InviteForm__closeBtn__3nNC9"}},11:function(e,t,n){e.exports={MainScreen:"MainScreen_MainScreen__3h_O-",MainScreen__container:"MainScreen_MainScreen__container__3UAEY",MainScreen__chat:"MainScreen_MainScreen__chat__1QF4Y",MainScreen__chatHidden:"MainScreen_MainScreen__chatHidden__1CvFO"}},21:function(e,t,n){e.exports={EnterScreen:"EnterScreen_EnterScreen__3UYiH",EnterScreen__container:"EnterScreen_EnterScreen__container__2gNhh"}},22:function(e,t,n){e.exports={Input:"Input_Input__SNRl4",invalid:"Input_invalid__1ZOur"}},23:function(e,t,n){e.exports={ChatList:"RoomList_ChatList__35jeu",ChatList__item:"RoomList_ChatList__item__1z7eS"}},40:function(e,t,n){e.exports={SendMessage:"SendMessage_SendMessage__36wf3"}},42:function(e,t,n){e.exports=n(80)},47:function(e,t,n){},77:function(e,t){},8:function(e,t,n){e.exports={Messages__list:"Messages_Messages__list__1Lc5l",Messages__name:"Messages_Messages__name__14m1u",Messages__time:"Messages_Messages__time__2j5Nc",Messages__text:"Messages_Messages__text__3UlYN",Messages:"Messages_Messages__cNd55"}},80:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(39),o=n.n(s),i=(n(47),n(1)),c=n(3),l=n(4),u=n(6),m=n(5),_=n(21),h=n.n(_),v=n(22),p=n.n(v);var g=function(e){var t=e.type||"text",n=[p.a.Input],a="".concat(t,"-").concat(Math.random());return function(e){var t=e.valid;return!e.touched||t}(e)||n.push(p.a.invalid),r.a.createElement("div",{className:n.join(" ")},r.a.createElement("label",{htmlFor:a},e.label),r.a.createElement("input",{type:t,id:a,value:e.value,placeholder:e.placeholder,onChange:e.onChange,className:e.classes}),r.a.createElement("span",null,e.errorMessage))},d=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isInputValid:!1,isInputTouched:!1},e.onInputChange=function(t){var n=!1;n=""!==t.target.value.trim(),e.setState({isInputValid:n,isInputTouched:!0}),n&&e.props.onInputLoginChange(t.target.value)},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:h.a.EnterScreen},r.a.createElement("div",null,r.a.createElement("h1",null,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u0451 \u0438\u043c\u044f"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault()}},r.a.createElement("div",{className:h.a.EnterScreen__container},r.a.createElement(g,{valid:this.state.isInputValid,touched:this.state.isInputTouched,onChange:function(t){e.onInputChange(t)},errorMessage:this.props.errorMessage,placeholder:"\u0418\u043c\u044f"}),r.a.createElement("button",{type:"submit",onClick:function(t){e.props.onLoginClick(t)},disabled:!this.state.isInputValid},"\u0412\u043e\u0439\u0442\u0438")))))}}]),n}(r.a.Component),f=n(9),M=n.n(f),E=function(e){return r.a.createElement("div",{className:M.a.Title},r.a.createElement("h2",null,"\u041a\u043e\u043c\u043d\u0430\u0442\u0430 \u2116 ".concat(e.title)),r.a.createElement("div",{className:M.a.Title__btnWrapper},r.a.createElement("button",{className:M.a.Title__btnMembers,title:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0435",onClick:function(t){!function(t){t.preventDefault(),document.querySelector(".membership-list-".concat(e.title)).classList.toggle("none")}(t)},type:"button"},"".concat(e.users.length," users")),r.a.createElement("ul",{className:"membership-list-".concat(e.title," none"),"aria-label":"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u043d\u0430\u0445\u043e\u0434\u044f\u0449\u0438\u0445\u0441\u044f \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0435"},e.users.map((function(e,t){return r.a.createElement("li",{key:e+t},e)}))),r.a.createElement("button",{className:M.a.Title__btnInvite,onClick:function(t){document.querySelector(".invite-form-".concat(e.title)).classList.toggle("flex")},"aria-label":"\u041f\u0440\u0438\u0433\u043b\u0430\u0441\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u043a\u043e\u043c\u043d\u0430\u0442\u0443",title:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435",type:"button"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M8.602 3.7c-1.154 1.937-.635 5.227 1.424 9.025.93 1.712.697 3.02.338 3.815-.982 2.178-3.675 2.799-6.525 3.456-1.964.454-1.839.87-1.839 4.004h-1.995l-.005-1.241c0-2.52.199-3.975 3.178-4.663 3.365-.777 6.688-1.473 5.09-4.418-4.733-8.729-1.35-13.678 3.732-13.678 3.321 0 5.97 2.117 5.97 6.167 0 3.555-1.949 6.833-2.383 7.833h-2.115c.392-1.536 2.499-4.366 2.499-7.842 0-5.153-5.867-4.985-7.369-2.458zm15.398 15.8c0 2.485-2.017 4.5-4.5 4.5s-4.5-2.015-4.5-4.5 2.017-4.5 4.5-4.5 4.5 2.015 4.5 4.5zm-2-.5h-2v-2h-1v2h-2v1h2v2h1v-2h2v-1z"})))))},b=n(8),S=n.n(b),I=function(e){return r.a.createElement("div",{className:S.a.Messages},r.a.createElement("ul",{className:S.a.Messages__list},e.messages.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("span",{className:S.a.Messages__name},e.name),r.a.createElement("span",{className:S.a.Messages__text},e.text),r.a.createElement("span",{className:S.a.Messages__time},e.time.hours,":",e.time.minutes))}))))},N=n(40),C=n.n(N),k=function(e){return r.a.createElement("div",{className:C.a.SendMessage},r.a.createElement("form",{onSubmit:e.onSubmitMessage},r.a.createElement(g,{placeholder:"\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",type:"text"})))},y=n(10),L=n.n(y),j=n(41),w=n.n(j)()("http://localhost:8000/"),F=function(e,t){return w.emit("newUser",{name:e,room:t}),new Promise((function(e,t){w.on("userExists",(function(e){t(e)})),w.on("userSet",(function(t){e(t)}))}))},O=function(){return w},x=function(e){var t=[L.a.InviteForm,"invite-form-".concat(e.roomNumber)],n=function(e,t,n){e.preventDefault(),function(e){w.emit("inviteUser",e)}({name:e.target.parentNode.querySelector("input").value,room:n,inviteFrom:t})};return r.a.createElement("form",{className:t.join(" ")},r.a.createElement("button",{className:L.a.InviteForm__closeBtn,type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0440\u043c\u0443 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0440\u043c\u0443 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438",onClick:function(t){document.querySelector(".invite-form-".concat(e.roomNumber)).classList.toggle("flex")}},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"}))),r.a.createElement(g,{errorMessage:e.errorMsg,classes:L.a.InviteForm__input,placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),r.a.createElement("button",{className:L.a.InviteForm__sendBtn,onClick:function(t){n(t,e.inviteFrom,e.roomNumber)},type:"submit"},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435"))},T=O(),D=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n);var r={messages:[],user:e.user,room:e.room,errMsg:""};return(a=t.call(this,r)).onSubmitMessage=function(e){e.preventDefault();var t=a.state,n=e.target.querySelector("input");if(""!==n.value.trim()){var r=new Date;!function(e){w.emit("createMessage",e)}({name:t.user.name,room:t.room.id,text:n.value,time:{hours:r.getHours(),minutes:r.getMinutes()}}),n.value=""}},a.state=Object(i.a)({},r),a}return Object(l.a)(n,[{key:"componentWillUpdate",value:function(e){var t=document.querySelector("."+e.className+" ul");t.scrollTop=t.scrollHeight}},{key:"componentDidMount",value:function(){var e=this;T.on("newMessage",(function(t){var n=e.state;t.room===e.state.room.id&&(n.messages.push(t),e.setState(Object(i.a)({},n)))})),T.on("userNotFound",(function(t){var n=e.state;n.errMsg=t.text,e.setState(Object(i.a)({},n))}))}},{key:"render",value:function(){return r.a.createElement("main",{className:this.props.className,room:this.props.room.id},r.a.createElement(E,{title:this.props.room.id,users:this.props.room.users}),r.a.createElement(x,{roomNumber:this.state.room.id,inviteFrom:this.state.user.name,errorMsg:this.state.errMsg}),r.a.createElement(I,{messages:this.state.messages}),r.a.createElement(k,{onSubmitMessage:this.onSubmitMessage}))}}]),n}(r.a.Component),B=n(23),q=n.n(B),R=function(e){return r.a.createElement("nav",{className:q.a.ChatList},r.a.createElement("h2",{className:"visually-hidden"},"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043c\u043d\u0430\u0442"),r.a.createElement("ul",null,e.rooms.map((function(t){return r.a.createElement("li",{className:q.a.ChatList__item,key:t.id},r.a.createElement("a",{onClick:e.onLinkClick,id:t.id},t.id))}))))},U=n(11),H=n.n(U),W=O(),z=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).renderChats=function(){return a.state.user.rooms.map((function(e,t){var n={};return n=e.id===+a.state.activeRoom?H.a.MainScreen__chat:H.a.MainScreen__chatHidden,r.a.createElement(D,{className:n,user:a.state.user,room:e,key:t+e.id})}))},a.onLinkClick=function(e){var t=e.target.getAttribute("id");a.setState({activeRoom:t})},a.state={activeRoom:e.user.rooms[0].id,loading:!1,user:e.user},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;W.on("newInvite",(function(t){var n=e.state;n.user.rooms.push(t),e.setState(Object(i.a)({},n))})),W.on("userConnected",(function(t){var n=e.state;n.user.rooms.find((function(e){return e.id===t.id})).users=t.users,n.inviteForm=!1,e.setState(Object(i.a)({},n))})),W.on("userDisconnected",(function(t){var n=e.state;n.user.rooms.forEach((function(e){e.users=e.users.filter((function(e){return e!==t}))})),e.setState(Object(i.a)({},n))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:H.a.MainScreen},r.a.createElement("div",{className:H.a.MainScreen__container},this.state.loading?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{rooms:this.state.user.rooms,onLinkClick:function(t){e.onLinkClick(t)}}),this.renderChats())))}}]),n}(r.a.Component),A=function(e){Object(u.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isLogged:!1,user:{id:null,name:"",rooms:[]},errorMessage:""},e.onLoginClick=function(t){t.preventDefault();var n=e.state;F(n.user.name,n.user.room).then((function(e){n.isLogged=!0,n.user.id=e.userId,n.user.rooms.push(e.room)})).catch((function(e){n.isLogged=!1,n.user.name="",n.user.rooms=[],n.errorMessage=e})).finally((function(){e.setState(Object(i.a)({},n))}))},e.onInputLoginChange=function(t){var n=e.state;n.user.name=t,e.setState({state:n})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},this.state.isLogged?r.a.createElement(z,{user:this.state.user}):r.a.createElement(d,{onLoginClick:this.onLoginClick,onInputLoginChange:this.onInputLoginChange,errorMessage:this.state.errorMessage}))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports={Title:"Title_Title__2JDeu",Title__btnInvite:"Title_Title__btnInvite__PUKdV",Title__btnMembers:"Title_Title__btnMembers__ji2oK",Title__btnWrapper:"Title_Title__btnWrapper__2MaYR"}}},[[42,1,2]]]);
//# sourceMappingURL=main.8efaec61.chunk.js.map